import numpy as np

def generate_check_params_file():
    d= {'fr': 0.7,
        'fg': 0.1,
        'fb': 0.0,
        'beta': 1.0,
        'amass_b': 1.0,
        'amass_r': 1.0,
        'amass_s': 1.0,
        'tau_b': 1.0,
        'tau_r': 1.0,
        'tau_s': 1.0,
        'tau_d': 2.0,
        'taubulk_b': 0.84,
        'taubulk_r': 0.84,
        'taubulk_s': 0.84,
        'taubulk_d': 1.68,
        'g_br': 0.08,
        'g_bs': -0.0,
        'g_ss': 0.0,
        'g_wr': 0.0,
        'g_wb': 0.0,
        'tau_wr': 1.0,
        'tau_wb': 1.0,
        'shear_u': 0.0,
        'shear_omega': 0.0,
        'g_accn': 0.0,
        'g_accn_x': 0.0,
        'g_accn_y': 0.0,
        's03_r': 1.0,
        's05_r': 1.0,
        's11_r': 1.0,
        's14_r': 1.0,
        's17_r': 1.0,
        's03_b': 1.0,
        's05_b': 1.0,
        's11_b': 1.0,
        's14_b': 1.0,
        's17_b': 1.0,
        's03_s': 1.0,
        's05_s': 1.0,
        's11_s': 1.0,
        's14_s': 1.0,
        's17_s': 1.0,
        'n_sci_int': 1000,
        'n_sci_sur': 100,
        'n_sci_od': 1000,
        'n_sci_wd': 1000,
        'n_sci_dir': 100,
        'n_sci_vel': 100,
        'n_sci_flo': 100,
        'n_sci_arrows': 100,
        'n_sci_rock': 100,
        'n_sci_rock_colour': 100,
        'n_sci_rock_rho_r': 100,
        'n_sci_rock_rho_b': 100,
        'n_sci_pressure': 200,
        'n_sci_fluxz': 50000,
        'n_sci_massfluxz': 100,
        'n_sci_profile': 5000,
        'n_sci_profile_dump': 1,
        'n_checkpoint': 5000,
        'g_accn_min': 0,
        'g_accn_max': 64,
        'g_accn_min_x': 0,
        'g_accn_max_x': 64,
        'g_accn_min_y': 0,
        'g_accn_max_y': 64}
    
    return d

def generate_curr_topo():
    d ={'cdims': [2, 1, 1],
        'all_ccoords': [0, 0, 0, 1, 0, 0],
        'nprocs': 2,
        'shear_sum': 0.0}
    
    return d

def generate_md_params():
    d = {'particles': [{'x': [9.998174410547719, 9.63912152267515, 1.266988548882485],
            'v': [-0.0006198224768080991, 0.0015769917147227322, 0.0017434310773042402],
            'q': [0.5361221269370345,
                -0.431039006723606,
                0.7027823649547414,
                0.1813157113982626],
            'w': [0.0013776904200538717, 0.001150714411778574, -0.004992370529335691],
            'uid': 7,
            'vnew': [-0.0006576190093237181,
                0.0015785710130132179,
                0.0017682482534146146],
            'qnew': [0.5362947098215637,
                -0.4317836513673895,
                0.702461068861031,
                0.18028052718444462],
            'wnew': [0.0013774463751822104,
                0.0011517969952651434,
                -0.004992021256176511],
            'master': 0,
            'ws': [-0.003974210530393917,
                -0.003500972450202598,
                0.00030282016847084326],
            'v_fluid': [-0.0005352559926868665,
                0.0015817123467358474,
                0.0016848479532567875],
            'ws_fluid': [-0.003974210530393917,
                -0.003500972450202598,
                0.00030282016847084326],
            'f_fluid': [0.0034458172316216584,
                -0.0020735752381614526,
                0.03141955397170503],
            't_fluid': [-0.007967477925094058,
                0.02499799552882412,
                0.006942413225704248]},
            {'x': [2.326110973773518, 21.199119456749244, 49.30836238064621],
            'v': [-0.0002463285335645257,
                -0.001771710832032495,
                -0.0010669029512443652],
            'q': [-0.36291347202815627,
                -0.43447578590760044,
                -0.36644057986956574,
                -0.7384076819110823],
            'w': [0.000541374271739128, 0.00019702463473151078, 0.0007577089490726021],
            'uid': 4,
            'vnew': [-0.00023406711725327387,
                -0.0017577289908501223,
                -0.0010791867410196337],
            'qnew': [-0.36269674456871165,
                -0.4345579467113763,
                -0.366476092697801,
                -0.7384482328077776],
            'wnew': [0.0005421784697024796,
                0.00019862947778533918,
                0.0007624849837422453],
            'master': 0,
            'ws': [0.00044355386144810937,
                0.0005371743198334549,
                0.0006302470653336246],
            'v_fluid': [-0.0002765853380931843,
                -0.0017970437910697409,
                -0.001043825348008984],
            'ws_fluid': [0.00044355386144810937,
                0.0005371743198334549,
                0.0006302470653336246],
            'f_fluid': [-0.006446606437504165,
                0.014189248556212562,
                -0.005408665870376236],
            't_fluid': [0.008152925079684417,
                -0.05516709150621135,
                -0.059068975607109137]},
            {'x': [14.990571810680448, 18.064638824334025, 62.07545400256079],
            'v': [0.0006957766846285482, 0.0008689590122933481, -0.0012507068968272892],
            'q': [0.6826905738600844,
                -0.16254703792211414,
                0.5056660009971566,
                -0.5018106577792854],
            'w': [0.0007542210812289418,
                -0.00033242747542100757,
                0.0006769684920936113],
            'uid': 1,
            'vnew': [0.0007039049057908326,
                0.0008989397295528458,
                -0.0011460999096070705],
            'qnew': [0.6828481746921665,
                -0.162374436788469,
                0.505542155587488,
                -0.5017769550546265],
            'wnew': [0.0007572883935219268,
                -0.00033350048786029435,
                0.0006754804011764223],
            'master': 0,
            'ws': [0.0003984884598740285,
                -0.0009762817651844469,
                0.00014448928069625937],
            'v_fluid': [0.0006707869408310943,
                0.0008130568502000447,
                -0.0014780596782706205],
            'ws_fluid': [0.0003984884598740285,
                -0.0009762817651844469,
                0.00014448928069625937],
            'f_fluid': [0.0013759456551976496,
                0.05565967680641479,
                0.06693212805140555],
            't_fluid': [0.01614035965424667,
                -0.031883192768689506,
                -0.013667456301181926]},
            {'x': [20.249140488069155, 10.717761472350603, 2.4512274294251073],
            'v': [-0.003063538622066996, -0.0006233666108503323, 0.0006505582669536624],
            'q': [-0.6379414294630532,
                0.7019405401880662,
                -0.08101818768953262,
                0.3061801167264558],
            'w': [-0.003936988172982877,
                -0.0009146849786907387,
                -0.0005217286932444676],
            'uid': 5,
            'vnew': [-0.0031616265525255733,
                -0.0006485372030678131,
                0.0006091725561529729],
            'qnew': [-0.6372291374584405,
                0.702649013543185,
                -0.081082111195834,
                0.30602307009283186],
            'wnew': [-0.003937539289571234,
                -0.0009159689248358482,
                -0.0005163855306395477],
            'master': 0,
            'ws': [-0.0036814242439563087,
                0.0016883064323778623,
                -0.00042296450339932365],
            'v_fluid': [-0.002905766586328536,
                -0.0005738927772992329,
                0.0007391170491461544],
            'ws_fluid': [-0.0036814242439563087,
                0.0016883064323778623,
                -0.00042296450339932365],
            'f_fluid': [0.00740490954343055,
                0.009785650386487713,
                0.015154135758751165],
            't_fluid': [0.06485165412580937,
                -0.10851323978464014,
                0.028173947805982424]},
            {'x': [60.19155405524122, 60.31534376596277, 1.4228056637537903],
            'v': [-0.0066972280471362024, -0.007406209925351383, -0.001627530262163253],
            'q': [-0.22974946194751888,
                0.5975967747467099,
                0.6275478956408772,
                0.4430315092900981],
            'w': [0.0022944838938219417, 0.0030870018052803665, 0.004980026055719757],
            'uid': 10,
            'vnew': [-0.006675255108395144,
                -0.007468050900901898,
                -0.0017317388933811811],
            'qnew': [-0.23112814117165378,
                0.5979043773758121,
                0.6268807062408228,
                0.4428466920857158],
            'wnew': [0.0022947194556478074,
                0.0030917325540951437,
                0.004978206044042969],
            'master': 0,
            'ws': [0.0037182501071616634, 0.005057761681016907, 0.0002189995561159841],
            'v_fluid': [-0.006662791726992093,
                -0.007392563062711138,
                -0.001509076647318074],
            'ws_fluid': [0.0037182501071616634,
                0.005057761681016907,
                0.0002189995561159841],
            'f_fluid': [0.14790515119872633,
                -0.11883444666479823,
                -0.15245919668871355],
            't_fluid': [0.14927219652435283, 0.0968462801515539, -0.2603470613171487]},
            {'x': [41.82896907418938, 64.19910278708856, 19.135819219430758],
            'v': [0.0012782519382226023, -0.0008071246596648748, -0.00473643494695197],
            'q': [0.7704733511891557,
                0.28331203419373535,
                -0.5605609719416333,
                -0.1089793701771627],
            'w': [-0.0008211784581816522,
                -0.0006013320499964482,
                0.00046034787438354306],
            'uid': 6,
            'vnew': [0.0012842587599946307,
                -0.0007660779317559988,
                -0.004754295394302875],
            'qnew': [0.770459785171414,
                0.2830729635751173,
                -0.5606870318428921,
                -0.10904837018738131],
            'wnew': [-0.0008236397200169555,
                -0.00060111163230577,
                0.0004682212362609695],
            'master': 0,
            'ws': [-0.0006217363437270537,
                -0.00023498122389758734,
                -0.0008967058910920463],
            'v_fluid': [0.0012769589600913436,
                -0.0008399547566279653,
                -0.0047781146901967695],
            'ws_fluid': [-0.0006217363437270537,
                -0.00023498122389758734,
                -0.0008967058910920463],
            'f_fluid': [0.01760237597915676,
                0.048211003746679346,
                -0.023957621285811182],
            't_fluid': [-0.09911662093262019,
                -0.05268703367055608,
                0.006066642684906032]},
            {'x': [63.575437577624314, 2.6045601408055967, 52.177349483264365],
            'v': [0.0010043490040402155, -0.0014696281711136525, 0.0036680564784701457],
            'q': [0.7172914985846557,
                0.3985327215265249,
                0.0658156749531286,
                0.567743668270554],
            'w': [-0.00020508714439231168,
                -0.0007415937626179419,
                -0.0016978279132786492],
            'uid': 3,
            'vnew': [0.001040263864095442,
                -0.0014719190979062856,
                0.003672730188292141],
            'qnew': [0.7175651169123245,
                0.3985732676010034,
                0.06582274101348709,
                0.5673686960654334],
            'wnew': [-0.00020474145158607678,
                -0.0007399776260918298,
                -0.0016949493770655368],
            'master': 0,
            'ws': [-0.00043616831240468623,
                0.0006400362045926131,
                -0.0017049400647831444],
            'v_fluid': [0.0009338275241668687,
                -0.001462942346594958,
                0.00365101897489418],
            'ws_fluid': [-0.00043616831240468623,
                0.0006400362045926131,
                -0.0017049400647831444],
            'f_fluid': [0.037711644966074154,
                -0.0019836981630222215,
                0.0032034065806029136],
            't_fluid': [0.0018041300544534011,
                -0.017531665757109093,
                0.019799502158932725]},
            {'x': [52.59573009565331, 63.31910943925053, 17.65134036995728],
            'v': [0.0034942627503927876, 9.426348588438728e-05, 0.00029562952962880235],
            'q': [0.443012121241122,
                -0.25785545629249423,
                0.6130423359099464,
                -0.601190417817606],
            'w': [0.0004972178762485688,
                -0.00047676671199078815,
                -0.0007726332146835496],
            'uid': 9,
            'vnew': [0.0034943352504501557,
                9.223096882863628e-05,
                0.0002742989763564493],
            'qnew': [0.4430011184441663,
                -0.2579904587384576,
                0.6128649949119725,
                -0.6013214591523147],
            'wnew': [0.0004958478436099125,
                -0.00047343758137924845,
                -0.0007765843905797072],
            'master': 0,
            'ws': [-0.000995578138483191,
                -0.00010482598818576413,
                0.0002573551907397759],
            'v_fluid': [0.0034681151316826326,
                7.841012896882858e-05,
                0.0003012829154217353],
            'ws_fluid': [-0.000995578138483191,
                -0.00010482598818576413,
                0.0002573551907397759],
            'f_fluid': [-0.0028495927178290702,
                -0.026678450628247988,
                -0.0405337846730532],
            't_fluid': [-0.04142038376236408,
                0.028487030694114207,
                -0.10048505823758258]},
            {'x': [60.889701526148556, 1.0651919323561598, 23.534818491789355],
            'v': [0.004882993971480605, -0.0007887686132513939, -0.0030567091737887103],
            'q': [-0.6351020587647869,
                -0.22838474858920133,
                -0.5672554388005905,
                -0.47191847676873805],
            'w': [-0.00032200850132859196,
                0.0010005909382908122,
                -0.00025674305147430077],
            'uid': 2,
            'vnew': [0.004973190457931088,
                -0.0007470486197395127,
                -0.0029925979087068733],
            'qnew': [-0.6350088371016092,
                -0.2281791624909532,
                -0.5673909770897664,
                -0.4719805069059499],
            'wnew': [-0.00031955790668691185,
                0.0010156727573650817,
                -0.00025318477227831486],
            'master': 0,
            'ws': [-0.0005529322484667612,
                8.650103790844577e-05,
                0.0008886098375780695],
            'v_fluid': [0.004710717800709464,
                -0.0008232958538370132,
                -0.0031774359083754904],
            'ws_fluid': [-0.0005529322484667612,
                8.650103790844577e-05,
                0.0008886098375780695],
            'f_fluid': [0.023432256213734792,
                0.11968408760823059,
                0.011640487103913664],
            't_fluid': [-0.06080419380787919,
                -0.1361525988535297,
                -0.08123631196639813]},
            {'x': [63.33438554941493, 62.993886617361525, 13.147843803810705],
            'v': [0.003258101768886369, 0.00024204865741403884, -0.0035031850528193407],
            'q': [-0.13097042020476737,
                -0.886714462232833,
                0.3301126090903525,
                0.29598965660658577],
            'w': [-0.0016314383501116305,
                0.0009436255587184118,
                -0.0002549015826960358],
            'uid': 8,
            'vnew': [0.003199160588587741,
                0.00021863332150334996,
                -0.0035651472509543184],
            'qnew': [-0.13139108888533543,
                -0.8867519068381935,
                0.329904483847772,
                0.2959234615227929],
            'wnew': [-0.0016234594644442381,
                0.0009393476734547236,
                -0.00026074506080186056],
            'master': 0,
            'ws': [-0.0013371328783680113, 0.0003884100659931, 0.0013233025356353127],
            'v_fluid': [0.0033746846667717695,
                0.0002858230304552265,
                -0.0033724594542564445],
            'ws_fluid': [-0.0013371328783680113,
                0.0003884100659931,
                0.0013233025356353127],
            'f_fluid': [0.010288166483242378,
                -0.00545481310945338,
                0.01229280447945641],
            't_fluid': [0.019575392931772795,
                -0.005625260817728628,
                0.07759042863552112]}],
            'ladd_data': {'pfr': 0.528656768798675,
            'pfb': 0.4283580780029297,
            'pfg': 0.0,
            'global_mass_change': [-19174.3848448527, 16747.25778767807],
            'global_mass_target': [135480.67499996274, 110840.0625]},
            'first_inserted_puid': None}
    return d

def generate_fluid_params():
    w = np.array([
        1./3.,
        1./18.,
        1./18.,
        1./18.,
        1./18.,
        1./18.,
        1./18.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.,
        1./36.])
    
    Q = 19
    boxDims = np.ones(3, dtype = int)*64    
    rho_coex = 0.7
    interface_width = 2
    R = 0.3*boxDims.min()

    com = boxDims//2
    radii = np.linalg.norm(np.indices(boxDims) - com[:, np.newaxis, np.newaxis, np.newaxis], axis = 0)
    phi0 = rho_coex*np.tanh(((R - radii)/interface_width))

    C1 = np.einsum("ijk, l -> ijkl", (phi0 + rho_coex)/2, w)
    C2 = np.einsum("ijk, l -> ijkl", (rho_coex - phi0)/2, w)

    generated_box = np.empty((*boxDims, 2*Q+4))
    generated_box[..., :19] = C1
    generated_box[..., 19:2*19] = C2
    generated_box[..., 2*19:] = 0

    return generated_box